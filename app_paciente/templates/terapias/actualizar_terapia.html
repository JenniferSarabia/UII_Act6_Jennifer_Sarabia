{% extends 'base.html' %}
{% block content %}
<h2 class="mb-4">Actualizar Terapia</h2>

<form method="post" action="{% url 'realizar_actualizacion_terapia' terapia.id %}">
    {% csrf_token %}

    <div class="mb-3">
        <label class="form-label">Nombre</label>
        <input type="text" name="nom_ter" value="{{ terapia.nom_ter }}" class="form-control" required>
    </div>

    <div class="mb-3">
        <label class="form-label">Descripción</label>
        <textarea name="desc_ter" class="form-control" rows="3">{{ terapia.desc_ter }}</textarea>
    </div>

    <div class="row mb-3">
        <div class="col-md-6">
            <label class="form-label">Duración (minutos)</label>
            <input type="number" name="duracion_ter" value="{{ terapia.duracion_ter }}" class="form-control" required>
        </div>
        <div class="col-md-6">
            <label class="form-label">Costo ($)</label>
            <input type="number" step="0.01" name="costo_ter" value="{{ terapia.costo_ter }}" class="form-control" required>
        </div>
    </div>

    <div class="mb-3">
        <label class="form-label">Frecuencia</label>
        <input type="text" name="frecuencia_ter" value="{{ terapia.frecuencia_ter }}" class="form-control">
    </div>

    <div class="mb-3">
        <label class="form-label">Nivel</label>
        <select name="nivel_ter" class="form-select">
            <option value="Física" {% if terapia.nivel_ter == "Física" %}selected{% endif %}>Física</option>
            <option value="Psicológica" {% if terapia.nivel_ter == "Psicológica" %}selected{% endif %}>Psicológica</option>
            <option value="Ocupacional" {% if terapia.nivel_ter == "Ocupacional" %}selected{% endif %}>Ocupacional</option>
            <option value="Lenguaje" {% if terapia.nivel_ter == "Lenguaje" %}selected{% endif %}>Lenguaje</option>
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Fecha de inicio</label>
        <input type="date" name="fecha_inicio" value="{{ terapia.fecha_inicio|date:'Y-m-d' }}" class="form-control">
    </div>

    <div class="mb-3">
        <label class="form-label">Paciente</label>
        <select name="paciente" class="form-select">
            {% for p in pacientes %}
            <option value="{{ p.id }}" {% if terapia.paciente.id == p.id %}selected{% endif %}>{{ p.nom_pac }} {{ p.ape_pac }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Terapeutas</label>
        <div class="d-flex flex-wrap">
            {% for t in terapeutas %}
            <div class="form-check me-3">
                <input class="form-check-input" type="checkbox" id="terapeuta{{ t.id }}" name="terapeutas" value="{{ t.id }}" {% if t in terapia.terapeutas.all %}checked{% endif %}>
                <label class="form-check-label" for="terapeuta{{ t.id }}">{{ t.nom_tep }} {{ t.ape_tep }}</label>
            </div>
            {% endfor %}
        </div>
    </div>

    <button type="submit" class="btn btn-primary">Guardar cambios</button>
    <a href="{% url 'ver_terapias' %}" class="btn btn-secondary ms-2">Cancelar</a>
</form>
{% endblock %}
